<?xml version="1.0" encoding="UTF-8"?>
<!--
================================================================================
DISCIPLESHIP PLANS LIST PAGE - METADATA-DRIVEN ARCHITECTURE
================================================================================

ARCHITECTURE OVERVIEW:
This XML blueprint defines the list page for discipleship plans using StewardTrack's
metadata-driven architecture. The architecture flow is:

  1. AUTHORING (this file) -> XML blueprint defines page structure
  2. COMPILATION         -> `npm run metadata:compile` validates and transforms to JSON
  3. REGISTRY            -> manifest.json maps module/route to compiled artifacts
  4. RESOLUTION          -> resolver.ts merges base + overlays based on context
  5. INTERPRETATION      -> interpreter.tsx renders React components from JSON

ADDING A NEW MODULE CHECKLIST:
  [ ] Create XML blueprints in metadata/authoring/blueprints/<module>/
      - <feature>-list.xml    (directory/search view)
      - <feature>-profile.xml (detail view)
      - <feature>-manage.xml  (create/edit form)
  [ ] Create service handlers in src/lib/metadata/services/admin-community-<feature>.ts
  [ ] Register handlers in src/lib/metadata/services/admin-community.ts
  [ ] Create metadata.ts render function in src/app/admin/community/<feature>/
  [ ] Create page.tsx components for each route
  [ ] Run `npm run metadata:compile` to validate and publish
  [ ] Test at /admin/community/<feature>

KEY CONCEPTS:

  kind="blueprint"    -> Base page definition (vs "overlay" for tenant customizations)
  module              -> Groups related pages; used in route resolution
  route               -> URL path segment after /admin/community/
  featureCode         -> License feature gate (checked in resolver)
  requiredPermissions -> RBAC permission check

DATA BINDING:
  Props with kind="binding" reference DataSource contracts:
    contract="listHero.eyebrow" -> DataSource id="listHero", Contract field "eyebrow"

  The Handler in DataSource Config specifies which service function resolves the data:
    <Handler>admin-community.discipleship.list.hero</Handler>
    -> Calls adminCommunityDiscipleshipHandlers['admin-community.discipleship.list.hero']

================================================================================
-->
<PageDefinition
  kind="blueprint"
  module="admin-community"
  route="discipleship-plans/list"
  schemaVersion="1.0.0"
  contentVersion="1.0.0"
  featureCode="discipleship.plans"
  requiredPermissions="members:view"
  locale="en-US">

  <Page id="admin-community-discipleship-plans-list">
    <Title>Member discipleship plans</Title>

    <!--
    REGIONS: Layout containers for components
    The "main" region is the primary content area rendered by interpreter.tsx
    -->
    <Regions>
      <Region id="main">
        <!--
        HERO SECTION: Page header with metrics and CTAs

        Component type "HeroSection" maps to src/components/dynamic/admin/HeroSection.tsx
        via the component registry in src/lib/metadata/component-registry.ts

        Prop kinds:
          - kind="static"  : Hardcoded value embedded in JSON
          - kind="binding" : Dynamic value from DataSource (resolved at runtime)
          - kind="action"  : References an Action definition below
        -->
        <Component id="list-hero" type="HeroSection">
          <Props>
            <Prop name="variant" kind="static">stats-panel</Prop>
            <Prop name="eyebrow" kind="binding" contract="listHero.eyebrow"/>
            <Prop name="headline" kind="binding" contract="listHero.headline"/>
            <Prop name="description" kind="binding" contract="listHero.description"/>
            <Prop name="metrics" kind="binding" contract="listHero.metrics"/>
            <Prop name="primaryCta" kind="action" actionId="launch-new-discipleship-plan"/>
            <Prop name="secondaryCta" kind="action" actionId="open-dashboard"/>
          </Props>
        </Component>

        <!--
        DATA GRID: Searchable, filterable table of discipleship plans

        Component type "AdminDataGridSection" provides:
          - Column definitions (type, sorting, formatting)
          - Filter controls (search, dropdowns)
          - Row actions (view, edit links)
          - Empty state messaging
        -->
        <Component id="discipleship-plans-grid" type="AdminDataGridSection">
          <Props>
            <Prop name="title" kind="static">Discipleship plan roster</Prop>
            <Prop name="description" kind="static">Search and manage member discipleship journeys with pathway, mentor, and milestone tracking.</Prop>
            <Prop name="rows" kind="binding" contract="discipleshipPlansTable.rows"/>
            <Prop name="columns" kind="binding" contract="discipleshipPlansTable.columns"/>
            <Prop name="filters" kind="binding" contract="discipleshipPlansTable.filters"/>
            <Prop name="actions" kind="binding" contract="discipleshipPlansTable.actions"/>
            <Prop name="emptyState" kind="static">{"title": "No discipleship plans found", "description": "Try adjusting your search or create a new discipleship plan record."}</Prop>
          </Props>
        </Component>
      </Region>
    </Regions>

    <!--
    DATA SOURCES: Define where component data comes from

    kind="service" -> Data resolved by a TypeScript handler function

    The Contract defines the shape of data expected by component bindings.
    Field paths map to the return object structure from the handler:
      path="hero.eyebrow" -> handler returns { hero: { eyebrow: "..." } }

    Handler naming convention: <module>.<feature>.<page>.<datasource>
      e.g., admin-community.discipleship.list.hero
    -->
    <DataSources>
      <!-- Hero section data: metrics, description, etc. -->
      <DataSource id="listHero" kind="service">
        <Contract>
          <Field name="eyebrow" path="hero.eyebrow" description="Binding for list-hero.eyebrow"/>
          <Field name="headline" path="hero.headline" description="Binding for list-hero.headline"/>
          <Field name="description" path="hero.description" description="Binding for list-hero.description"/>
          <Field name="metrics" path="hero.metrics" description="Binding for list-hero.metrics"/>
        </Contract>
        <Config>
          <Handler>admin-community.discipleship.list.hero</Handler>
        </Config>
      </DataSource>

      <!-- Table data: rows, columns, filters, actions -->
      <DataSource id="discipleshipPlansTable" kind="service">
        <Contract>
          <Field name="rows" path="table.rows" description="Binding for discipleship-plans-grid.rows"/>
          <Field name="columns" path="table.columns" description="Binding for discipleship-plans-grid.columns"/>
          <Field name="filters" path="table.filters" description="Binding for discipleship-plans-grid.filters"/>
          <Field name="actions" path="table.actions" description="Binding for discipleship-plans-grid.actions"/>
        </Contract>
        <Config>
          <Handler>admin-community.discipleship.list.table</Handler>
        </Config>
      </DataSource>
    </DataSources>

    <!--
    ACTIONS: User interactions (navigation, form submission, etc.)

    kind="link" -> Simple navigation to another page
    kind="service" -> Calls a service handler (for form submissions)

    Actions are referenced by components via actionId attribute.
    -->
    <Actions>
      <Action id="launch-new-discipleship-plan" kind="link">
        <Config>
          <Label>Add discipleship plan</Label>
          <Url>/admin/community/discipleship-plans/manage</Url>
        </Config>
      </Action>
      <Action id="open-dashboard" kind="link">
        <Config>
          <Label>Dashboard</Label>
          <Url>/admin/members</Url>
          <Variant>secondary</Variant>
        </Config>
      </Action>
    </Actions>
  </Page>
</PageDefinition>
