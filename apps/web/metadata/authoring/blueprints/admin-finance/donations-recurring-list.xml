<?xml version="1.0" encoding="UTF-8"?>
<!--
  ================================================================================
  RECURRING DONATIONS LIST PAGE
  ================================================================================

  Displays all recurring donation subscriptions for the tenant with:
  - Summary metrics (MRR, active donors, status breakdown)
  - Filterable/searchable data grid
  - Actions to pause, resume, cancel recurring donations

  Route: /admin/finance/donations/recurring
  ================================================================================
-->
<PageDefinition
  kind="blueprint"
  module="admin-finance"
  route="donations/recurring/list"
  schemaVersion="1.0.0"
  contentVersion="1.0.0"
  featureCode="donations.core"
  requiredPermissions="donations:view"
  locale="en-US">

  <Page id="admin-finance-donations-recurring-list">
    <Title>Recurring Donations</Title>

    <Regions>
      <Region id="main">
        <!-- Hero Section with key metrics -->
        <Component id="list-hero" type="HeroSection">
          <Props>
            <Prop name="variant" kind="static">stats-panel</Prop>
            <Prop name="eyebrow" kind="binding" contract="listHero.eyebrow"/>
            <Prop name="headline" kind="binding" contract="listHero.headline"/>
            <Prop name="description" kind="binding" contract="listHero.description"/>
            <Prop name="metrics" kind="binding" contract="listHero.metrics"/>
          </Props>
        </Component>

        <!-- Summary Metric Cards -->
        <Component id="summary-cards" type="AdminMetricCards">
          <Props>
            <Prop name="metrics" kind="binding" contract="summaryCards.items"/>
          </Props>
        </Component>

        <!-- Status Overview Cards -->
        <Component id="status-overview" type="AdminMetricCards">
          <Props>
            <Prop name="metrics" kind="binding" contract="statusOverview.items"/>
            <Prop name="columns" kind="static">4</Prop>
          </Props>
        </Component>

        <!-- Data Grid Table -->
        <Component id="recurring-table" type="AdminDataGridSection">
          <Props>
            <Prop name="rows" kind="binding" contract="recurringTable.rows"/>
            <Prop name="columns" kind="binding" contract="recurringTable.columns"/>
            <Prop name="filters" kind="binding" contract="recurringTable.filters"/>
            <Prop name="emptyState" kind="binding" contract="recurringTable.emptyState"/>
          </Props>
        </Component>
      </Region>
    </Regions>

    <!-- Data Sources -->
    <DataSources>
      <!-- Hero section data -->
      <DataSource id="listHero" kind="service">
        <Contract>
          <Field name="eyebrow" path="eyebrow"/>
          <Field name="headline" path="headline"/>
          <Field name="description" path="description"/>
          <Field name="metrics" path="metrics"/>
        </Contract>
        <Config>
          <Handler>admin-finance.donations.recurring.list.hero</Handler>
        </Config>
      </DataSource>

      <!-- Summary cards data -->
      <DataSource id="summaryCards" kind="service">
        <Contract>
          <Field name="items" path="items"/>
        </Contract>
        <Config>
          <Handler>admin-finance.donations.recurring.list.summary</Handler>
        </Config>
      </DataSource>

      <!-- Status overview cards -->
      <DataSource id="statusOverview" kind="service">
        <Contract>
          <Field name="items" path="items"/>
        </Contract>
        <Config>
          <Handler>admin-finance.donations.recurring.list.statusOverview</Handler>
        </Config>
      </DataSource>

      <!-- Table data -->
      <DataSource id="recurringTable" kind="service">
        <Contract>
          <Field name="rows" path="rows"/>
          <Field name="columns" path="columns"/>
          <Field name="filters" path="filters"/>
          <Field name="emptyState" path="emptyState"/>
        </Contract>
        <Config>
          <Handler>admin-finance.donations.recurring.list.table</Handler>
        </Config>
      </DataSource>
    </DataSources>

    <!-- Page Actions -->
    <Actions>
      <Action id="back-to-donations" kind="link">
        <Config>
          <Label>Back to Donations</Label>
          <Url>/admin/finance/donations</Url>
          <Variant>secondary</Variant>
          <Icon>arrow-left</Icon>
        </Config>
      </Action>

      <Action id="export-recurring" kind="link">
        <RBAC requirePermissions="donations:export"/>
        <Config>
          <Label>Export</Label>
          <Url>/api/donations/recurring/export</Url>
          <Variant>secondary</Variant>
          <Icon>download</Icon>
        </Config>
      </Action>
    </Actions>
  </Page>
</PageDefinition>
