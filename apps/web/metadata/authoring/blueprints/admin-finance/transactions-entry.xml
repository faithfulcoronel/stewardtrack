<?xml version="1.0" encoding="UTF-8"?>
<PageDefinition kind="blueprint" module="admin-finance" route="transactions/entry" schemaVersion="1.0.0" contentVersion="1.0.0" featureCode="finance.core" requiredPermissions="finance:edit" locale="en-US">
  <Page id="admin-finance-transactions-entry">
    <Title>Record transaction</Title>
    <Regions>
      <Region id="main">
        <Component id="transaction-entry" type="AdminTransactionEntry">
          <Props>
            <Prop name="eyebrow" kind="binding" contract="formHeader.eyebrow"/>
            <Prop name="headline" kind="binding" contract="formHeader.headline"/>
            <Prop name="pageDescription" kind="binding" contract="formHeader.description"/>
            <Prop name="accountOptions" kind="binding" contract="lineItems.accountOptions"/>
            <Prop name="categoryOptions" kind="binding" contract="lineItems.categoryOptions"/>
            <Prop name="fundOptions" kind="binding" contract="lineItems.fundOptions"/>
            <Prop name="sourceOptions" kind="binding" contract="lineItems.sourceOptions"/>
            <Prop name="budgetOptions" kind="binding" contract="lineItems.budgetOptions"/>
            <Prop name="currency" kind="binding" contract="lineItems.currency"/>
            <Prop name="defaultTransactionType" kind="binding" contract="lineItems.transactionType"/>
            <Prop name="initialData" kind="binding" contract="lineItems.initialData"/>
            <Prop name="cancelUrl" kind="static">/admin/finance/transactions</Prop>
          </Props>
        </Component>
      </Region>
    </Regions>
    <DataSources>
      <DataSource id="formHeader" kind="service">
        <Contract>
          <Field name="eyebrow" path="eyebrow" description="Form eyebrow text"/>
          <Field name="headline" path="headline" description="Form headline"/>
          <Field name="description" path="description" description="Form description"/>
        </Contract>
        <Config>
          <Handler>admin-finance.transactions.entry.header</Handler>
        </Config>
      </DataSource>
      <DataSource id="lineItems" kind="service">
        <Contract>
          <Field name="categoryOptions" path="categoryOptions" description="Category dropdown options"/>
          <Field name="sourceOptions" path="sourceOptions" description="Source dropdown options"/>
          <Field name="fundOptions" path="fundOptions" description="Fund dropdown options"/>
          <Field name="accountOptions" path="accountOptions" description="Account dropdown options"/>
          <Field name="budgetOptions" path="budgetOptions" description="Budget dropdown options"/>
          <Field name="transactionType" path="transactionType" description="Transaction type (income/expense)"/>
          <Field name="currency" path="currency" description="Tenant currency code"/>
          <Field name="initialData" path="initialData" description="Initial transaction data for editing"/>
        </Contract>
        <Config>
          <Handler>admin-finance.transactions.entry.lineItems</Handler>
        </Config>
      </DataSource>
    </DataSources>
    <Actions>
      <Action id="save-transaction" kind="submit">
        <Config>
          <Label>Submit transaction</Label>
          <Handler>admin-finance.transactions.submit</Handler>
          <SuccessUrl>/admin/finance/transactions</SuccessUrl>
          <SuccessMessage>Transaction submitted successfully</SuccessMessage>
          <Variant>primary</Variant>
        </Config>
      </Action>
      <Action id="save-draft" kind="submit">
        <Config>
          <Label>Save as draft</Label>
          <Handler>admin-finance.transactions.saveDraft</Handler>
          <SuccessUrl>/admin/finance/transactions</SuccessUrl>
          <SuccessMessage>Draft saved successfully</SuccessMessage>
          <Variant>secondary</Variant>
        </Config>
      </Action>
      <Action id="cancel" kind="link">
        <Config>
          <Label>Cancel</Label>
          <Url>/admin/finance/transactions</Url>
          <Variant>ghost</Variant>
        </Config>
      </Action>
    </Actions>
  </Page>
</PageDefinition>
